

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/SIB_logo.svg">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Quality control - NGS - Quality control, Alignment, Visualisation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YX61LNKWGY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YX61LNKWGY');
</script>

    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#material" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="NGS - Quality control, Alignment, Visualisation" class="md-header-nav__button md-logo" aria-label="NGS - Quality control, Alignment, Visualisation">
      
  <img src="../../assets/images/SIB_logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            NGS - Quality control, Alignment, Visualisation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Quality control
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/sib-swiss/NGS-introduction-training" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sib-swiss/NGS-introduction-training
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NGS - Quality control, Alignment, Visualisation" class="md-nav__button md-logo" aria-label="NGS - Quality control, Alignment, Visualisation">
      
  <img src="../../assets/images/SIB_logo.svg" alt="logo">

    </a>
    NGS - Quality control, Alignment, Visualisation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/sib-swiss/NGS-introduction-training" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sib-swiss/NGS-introduction-training
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../precourse/" class="md-nav__link">
      Precourse preparations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../course_schedule/" class="md-nav__link">
      Course schedule
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Day 1
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Day 1" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Day 1
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../intro/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sequencing_technologies/" class="md-nav__link">
      Sequencing technologies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../server_login/" class="md-nav__link">
      Setup + UNIX refresher
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Quality control
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Quality control
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#material" class="md-nav__link">
    Material
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    Exercises
  </a>
  
    <nav class="md-nav" aria-label="Exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-download-and-evaluate-an-e-coli-dataset" class="md-nav__link">
    1. Download and evaluate an E. coli dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-run-fastqc" class="md-nav__link">
    2. Run fastqc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-trim-the-reads" class="md-nav__link">
    3. Trim the reads
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../read_alignment/" class="md-nav__link">
      Read alignment
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Day 2
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Day 2" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Day 2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../day2/file_types/" class="md-nav__link">
      File types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../day2/samtools/" class="md-nav__link">
      Samtools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../day2/igv_visualisation/" class="md-nav__link">
      IGV and visualisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../day2/group_work/" class="md-nav__link">
      Group work - organisation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../day3/" class="md-nav__link">
      Day 3
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#material" class="md-nav__link">
    Material
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    Exercises
  </a>
  
    <nav class="md-nav" aria-label="Exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-download-and-evaluate-an-e-coli-dataset" class="md-nav__link">
    1. Download and evaluate an E. coli dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-run-fastqc" class="md-nav__link">
    2. Run fastqc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-trim-the-reads" class="md-nav__link">
    3. Trim the reads
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Quality control</h1>
                
                <h2 id="material">Material</h2>
<p><a class="md-button" href="../../assets/pdf/quality_control.pdf"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"/></svg></span> Download the presentation</a></p>
<ul>
<li><code>fastqc</code> command line <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/INSTALL.txt">documentation</a></li>
<li><code>trimmomatic</code> <a href="http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/TrimmomaticManual_V0.32.pdf">manual</a></li>
<li>Unix command line <a href="https://www.ncbi.nlm.nih.gov/books/NBK179288/">E-utilities documentation</a></li>
</ul>
<h2 id="exercises">Exercises</h2>
<h3 id="1-download-and-evaluate-an-e-coli-dataset">1. Download and evaluate an E. coli dataset</h3>
<blockquote>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg></span> 30 minutes</p>
</blockquote>
<p><strong>Exercise:</strong> Create a directory called <code>workdir</code> in your home directory and make the directory your current directory.</p>
<div class="admonition note">
<p class="admonition-title">If working with Docker</p>
<p>If you have mounted your local directory to <code>/root/workdir</code>, this directory should already exist.</p>
</div>
<details class="done"><summary>Answer</summary><div class="highlight"><pre><span></span><code><span class="nb">cd</span> ~
mkdir workdir
<span class="nb">cd</span> workdir
</code></pre></div>
</details>
<p>Check out the dataset at <a href="https://www.ncbi.nlm.nih.gov/sra/?term=SRR519926">SRA</a>.</p>
<p><strong>Exercise:</strong> Browse around the SRA entry and answer these questions:</p>
<p><strong>A.</strong> Is the dataset paired-end or single end?</p>
<p><strong>B.</strong> Which instrument was used for sequencing?</p>
<p><strong>C.</strong> What is the read length?</p>
<p><strong>D.</strong> How many reads do we have?</p>
<details class="done"><summary>Answers</summary><p>A. paired-end</p>
<p>B. Illumina MiSeq</p>
<p>C. 2 x 252 bp</p>
<p>D. 400596</p>
</details>
<p>Make a directory <code>reads</code> in <code>~/workdir</code> and download the reads from the SRA database using <code>prefetch</code> and <code>fastq-dump</code> from <a href="https://ncbi.github.io/sra-tools/">SRA-Tools</a> into the <code>reads</code> directory:</p>
<div class="highlight"><pre><span></span><code>mkdir reads
<span class="nb">cd</span> reads
prefetch SRR519926
fastq-dump --split-files SRR519926
</code></pre></div>
<p><strong>Exercise:</strong> Check whether the download was successful by counting the number of reads in the fastq files and compare it to the SRA entry.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A read in a fastq file consists of four lines (more on that at <a href="../../day2/file_types/">file types</a>). Use Google to figure out how to count the number of reads in a fastq file.</p>
</div>
<details class="done"><summary>Answer</summary><p>e.g. from <a href="https://www.biostars.org/p/139006/">this</a> thread on Biostars:</p>
<div class="highlight"><pre><span></span><code><span class="c1">## forward read</span>
<span class="nb">echo</span> <span class="k">$(</span>cat SRR519926_1.fastq <span class="p">|</span> wc -l<span class="k">)</span>/4 <span class="p">|</span> bc

<span class="c1">## reverse read</span>
<span class="nb">echo</span> <span class="k">$(</span>cat SRR519926_2.fastq <span class="p">|</span> wc -l<span class="k">)</span>/4 <span class="p">|</span> bc
</code></pre></div>
</details>
<h3 id="2-run-fastqc">2. Run fastqc</h3>
<blockquote>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg></span> 20 minutes</p>
</blockquote>
<p><strong>Exercise:</strong> Run fastqc on the fastq files.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code>fastqc</code> accepts multiple files as input, so you can use a <a href="https://en.wikipedia.org/wiki/Glob_(programming)">wildcard</a> to run <code>fastqc</code> on all the files in one line of code. Use it like this: <code>*.fastq</code>.  </p>
</div>
<details class="done"><summary>Answer</summary><div class="highlight"><pre><span></span><code>fastqc *.fastq
</code></pre></div>
</details>
<p><strong>Exercise:</strong> Download the html files to your local computer, and view the results. How is the quality? Where are the problems?</p>
<details class="done"><summary>Answer</summary><p>There seems to be:</p>
<ul>
<li>Low quality towards the 3&rsquo; end (per base sequence quality)</li>
<li>Full sequence reads with low quality (per sequence quality scores)</li>
<li>Adapters in the sequences (adapter content)</li>
</ul>
<p>We can probably fix most of these issues by trimming.</p>
</details>
<h3 id="3-trim-the-reads">3. Trim the reads</h3>
<blockquote>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg></span> 20 minutes</p>
</blockquote>
<p>We will use <a href="http://www.usadellab.org/cms/?page=trimmomatic">trimmomatic</a> for trimming low quality and spurious bases from our reads. For paired-end data it generates four different trimmed <code>fastq</code> files. If one of the paired-end reads doesn&rsquo;t meet the quality thresholds, it will be discarded, but the other read might be kept. Therefore, trimmomatic outputs contains files with unpaired reads as well. Usually those files are very small compared to the paired reads, and are often ignored for downstream analyses.</p>
<p>Trimmomatic syntax is rather complicated and different from most tools. Refer to the <a href="http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/TrimmomaticManual_V0.32.pdf">manual</a> if you want to go deeper into this.</p>
<p><strong>Exercise:</strong> The script below will trim the sequence reads in a sensible manner. Execute the script to trim the data (note that the script is slightly different if you&rsquo;re working in the docker container):</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">AWS</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">##!/usr/bin/env bash</span>

<span class="nv">TRIMMED_DIR</span><span class="o">=</span>~/workdir/trimmed_data
<span class="nv">READS_DIR</span><span class="o">=</span>~/workdir/reads
<span class="nv">ADAPTERS</span><span class="o">=</span>/opt/miniconda3/pkgs/trimmomatic-0.39-1/share/trimmomatic/adapters/TruSeq3-PE.fa

mkdir <span class="nv">$TRIMMED_DIR</span>

trimmomatic <span class="se">\</span>
PE <span class="se">\</span>
-threads <span class="m">1</span> <span class="se">\</span>
-phred33 <span class="se">\</span>
<span class="nv">$READS_DIR</span>/SRR519926_1.fastq <span class="se">\</span>
<span class="nv">$READS_DIR</span>/SRR519926_2.fastq <span class="se">\</span>
<span class="nv">$TRIMMED_DIR</span>/paired_trimmed_SRR519926_1.fastq <span class="se">\</span>
<span class="nv">$TRIMMED_DIR</span>/unpaired_trimmed_SRR519926_1.fastq <span class="se">\</span>
<span class="nv">$TRIMMED_DIR</span>/paired_trimmed_SRR519926_2.fastq <span class="se">\</span>
<span class="nv">$TRIMMED_DIR</span>/unpaired_trimmed_SRR519926_2.fastq <span class="se">\</span>
ILLUMINACLIP:<span class="nv">$ADAPTERS</span>:2:30:10 <span class="se">\</span>
SLIDINGWINDOW:4:5 <span class="se">\</span>
LEADING:5 <span class="se">\</span>
TRAILING:5 <span class="se">\</span>
MINLEN:25
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Docker</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">##!/usr/bin/env bash</span>

<span class="nv">TRIMMED_DIR</span><span class="o">=</span>~/workdir/trimmed_data
<span class="nv">READS_DIR</span><span class="o">=</span>~/workdir/reads
<span class="nv">ADAPTERS</span><span class="o">=</span>/opt/conda/pkgs/trimmomatic-0.39-1/share/trimmomatic/adapters/TruSeq3-PE.fa

mkdir <span class="nv">$TRIMMED_DIR</span>

trimmomatic <span class="se">\</span>
PE <span class="se">\</span>
-threads <span class="m">1</span> <span class="se">\</span>
-phred33 <span class="se">\</span>
<span class="nv">$READS_DIR</span>/SRR519926_1.fastq <span class="se">\</span>
<span class="nv">$READS_DIR</span>/SRR519926_2.fastq <span class="se">\</span>
<span class="nv">$TRIMMED_DIR</span>/paired_trimmed_SRR519926_1.fastq <span class="se">\</span>
<span class="nv">$TRIMMED_DIR</span>/unpaired_trimmed_SRR519926_1.fastq <span class="se">\</span>
<span class="nv">$TRIMMED_DIR</span>/paired_trimmed_SRR519926_2.fastq <span class="se">\</span>
<span class="nv">$TRIMMED_DIR</span>/unpaired_trimmed_SRR519926_2.fastq <span class="se">\</span>
ILLUMINACLIP:<span class="nv">$ADAPTERS</span>:2:30:10 <span class="se">\</span>
SLIDINGWINDOW:4:5 <span class="se">\</span>
LEADING:5 <span class="se">\</span>
TRAILING:5 <span class="se">\</span>
MINLEN:25
</code></pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">The use of <code>\</code></p>
<p>In the script above you see that we&rsquo;re using <code>\</code> at the end of many lines. We use it to tell bash to ignore the newlines. If we would not do it, the <code>trimmomatic</code> command would become a very long line, and the script would become very difficult to read. It is in general good practice to put every option of a long command on a newline in your script and use <code>\</code> to ignore the newlines when executing.</p>
</div>
<p><strong>Exercise:</strong> Run <code>fastqc</code> on the trimmed fastq files and answer these questions:</p>
<p><strong>A.</strong> Has the quality improved?</p>
<p><strong>B.</strong> How many reads do we have left?</p>
<p><strong>C.</strong> There are more unpaired forward reads compared to reverse reads. Does this make sense?</p>
<details class="done"><summary>Answers</summary><p>Running <code>fastqc</code>:
<div class="highlight"><pre><span></span><code>cd ~/workdir/trimmed_data
fastqc paired_trimmed*.fastq
</code></pre></div></p>
<p>A. Yes, low quality 3&rsquo; end, per sequence quality and adapter sequences have improved.</p>
<p>B. 264781</p>
<p>C. Again, <a href="https://www.biostars.org/p/325174/#325193">Google to the rescue</a></p>
</details>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../server_login/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Setup + UNIX refresher
              </div>
            </div>
          </a>
        
        
          <a href="../read_alignment/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Read alignment
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>